<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edit Profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Slab:wght@300;400;500;700&family=Roboto+Serif&family=Sedan+SC&family=Rokkitt:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="bg-[#00C8B3]/40 font-roboto">
    <div class="max-w-4xl mx-auto mt-10 mb-10 bg-white p-10 rounded-xl shadow-lg border border-[#AC7F5E]">
      <h2 class="text-3xl font-roboto_slab text-[#AC7F5E] mb-6">Edit Profile</h2>
      <form id="editForm" class="space-y-6">
        <h3 class="font-roboto_slab text-xl text-[#AC7F5E]">Basic Information</h3>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="font-semibold">Name</label>
            <input type="text" id="name" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Email</label>
            <input type="email" id="email" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Gender</label>
            <input type="text" id="gender" class="w-full border p-2 rounded" placeholder="Male, Female, or Others" />
          </div>
          <div>
            <label class="font-semibold">DOB</label>
            <input type="date" id="dob" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Contact</label>
            <input type="text" id="contact" class="w-full border p-2 rounded" maxlength="10" />
          </div>
          <div>
            <label class="font-semibold">Emergency Contact</label>
            <input type="text" id="parentContact" class="w-full border p-2 rounded" maxlength="10" />
          </div>
        </div>
        <h3 class="font-roboto_slab text-xl text-[#AC7F5E]">Professional Information</h3>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="font-semibold">Admin ID</label>
            <input type="text" id="adminId" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Department</label>
            <input type="text" id="department" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Admin Role</label>
            <input type="text" id="adminRole" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Office Location</label>
            <input type="text" id="office" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Years of Service</label>
            <input type="number" id="serviceYears" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">System Access Level</label>
            <input type="text" id="access" class="w-full border p-2 rounded" />
          </div>
          <div>
            <label class="font-semibold">Employment Type</label>
            <input type="text" id="employment" class="w-full border p-2 rounded" />
          </div>
        </div>
        <div class="bg-white border border-[#AC7F5E] shadow-lg p-6 rounded-xl space-y-6">
          <h2 class="text-xl font-roboto_slab text-[#AC7F5E]">Achievements</h2>
          <h3 class="font-roboto_slab text-lg text-[#AC7F5E]">Professional Achievements</h3>
          <div id="badgeBox" class="space-y-3"></div>
          <button type="button" onclick="addBadge()" class="px-4 py-1 bg-[#53afaa] text-white rounded">+ Add More Badge</button>
          <h3 class="font-roboto_slab text-lg text-[#AC7F5E]">Technical / Research</h3>
          <div id="milestoneBox" class="space-y-3"></div>
          <button type="button" onclick="addMilestone()" class="px-4 py-1 bg-[#53afaa] text-white rounded">+ Add More</button>
          <h3 class="font-roboto_slab text-lg text-[#AC7F5E]">Teaching & Institutional</h3>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="font-semibold">EdTech Innovator</label>
              <input type="text" id="innovator" class="w-full border p-2 rounded" />
            </div>
          </div>
        </div>
        <div class="flex justify-end gap-4 pt-6">
          <button type="button" onclick="window.location.href='AdminProfile.html'" class="px-6 py-2 bg-gray-300 rounded-lg">Cancel</button>
          <button type="submit" class="px-6 py-2 bg-[#50C878] text-white rounded-lg">Update</button>
        </div>
      </form>
    </div>
    <script>
      function validateInput() {
        const charOnlyFields = ["name", "department", "adminRole", "employment", "office"];
        charOnlyFields.forEach(id => {
          document.getElementById(id).addEventListener("input", function() {
            if (/[^a-zA-Z\s]/.test(this.value)) {
              this.value = this.value.replace(/[^a-zA-Z\s]/g, "");
              this.setCustomValidity("Only characters allowed");
              this.reportValidity();
            } else { this.setCustomValidity(""); }
          });
        });

        const numericFields = ["contact", "parentContact"];
        numericFields.forEach(id => {
          document.getElementById(id).addEventListener("input", function() {
            this.value = this.value.replace(/\D/g, "");
            if (this.value.length !== 10) {
              this.setCustomValidity("Must be exactly 10 digits");
              this.reportValidity();
            } else { this.setCustomValidity(""); }
          });
        });

        document.getElementById("gender").addEventListener("input", function() {
          const val = this.value.toLowerCase();
          const allowed = ["male", "female", "others"];
          const isPartialMatch = allowed.some(option => option.startsWith(val));
          if (!isPartialMatch && val !== "") {
            this.value = this.value.slice(0, -1);
            this.setCustomValidity("Must be Male, Female, or Others");
            this.reportValidity();
          } else { this.setCustomValidity(""); }
        });
      }

      function loadAdminData() {
        const saved = JSON.parse(localStorage.getItem("adminProfileData")) || {};
        document.getElementById("name").value = saved.name || "Yasra";
        document.getElementById("email").value = saved.email || "yasra@gmail.com";
        document.getElementById("gender").value = saved.gender || "Female";
        document.getElementById("dob").value = saved.dob || "";
        document.getElementById("contact").value = saved.contact || "0000000000";
        document.getElementById("parentContact").value = saved.emergencyContact || "0000000000";
        document.getElementById("adminId").value = saved.adminId || "ADM001";
        document.getElementById("department").value = saved.department || "Administration";
        document.getElementById("adminRole").value = saved.adminRole || "System Administrator";
        document.getElementById("office").value = saved.office || "Main Campus - Block A";
        document.getElementById("serviceYears").value = saved.serviceYears || "3";
        document.getElementById("access").value = saved.access || "Full Access";
        document.getElementById("employment").value = saved.employment || "Full-Time";
      }

      loadAdminData();
      validateInput();

      document.getElementById("editForm").addEventListener("submit", function (e) {
        const contact = document.getElementById("contact").value;
        const eContact = document.getElementById("parentContact").value;
        const gender = document.getElementById("gender").value.toLowerCase();
        
        if (contact.length !== 10 || eContact.length !== 10) {
          e.preventDefault();
          alert("Contacts must be exactly 10 digits");
          return;
        }
        if (!["male", "female", "others"].includes(gender)) {
          e.preventDefault();
          alert("Gender must be Male, Female, or Others");
          return;
        }

        e.preventDefault();
        const updatedData = {
          name: document.getElementById("name").value,
          email: document.getElementById("email").value,
          gender: document.getElementById("gender").value,
          dob: document.getElementById("dob").value,
          contact: contact,
          emergencyContact: eContact,
          adminId: document.getElementById("adminId").value,
          department: document.getElementById("department").value,
          adminRole: document.getElementById("adminRole").value,
          office: document.getElementById("office").value,
          serviceYears: document.getElementById("serviceYears").value,
          access: document.getElementById("access").value,
          employment: document.getElementById("employment").value,
        };
        localStorage.setItem("adminProfileData", JSON.stringify(updatedData));
        alert("Profile updated successfully!");
        window.location.href = "AdminProfile.html";
      });

      function addBadge() {}
      function addMilestone() {}
    </script>
  </body>
</html>